<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics</title>
    <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
    <script>
        window.onload = function () {
            //pie chart
            var chart = new CanvasJS.Chart("chartContainer", {
                theme: "light1",  // "light1", "light2", "dark1", "dark2"
                animationEnabled: true,
                title: {
                    text: "Tags of {{handle}}"
                },
                legend: {
                    cursor: "pointer",
                    itemclick: explodePie
                },
                data: [{
                    type: "doughnut",
                    innerRadius: 68,
                    showInLegend: true,
                    toolTipContent: "<b>{name}</b>: {y}",// (#percent%)
                    //indexLabel: "{name} - #percent%",
                    dataPoints: [
                        {{#each tags}}
                        { y: {{this}}, name: "{{@key}}" },
                        {{/each}}
                    ]
                }]
            });
            chart.render();

            //bar chart for rating
            var chart = new CanvasJS.Chart("chartContainer1", {
                animationEnabled: true,
                theme: "light2", // "light1", "light2", "dark1", "dark2"
                title: {
                text: "Problem Rating of {{handle}}"
                },
                axisX: {
                    interval:1,
                    labelAutoFit: false
                },
                data: [{
                    type: "column",
                    dataPoints: [
                    {{#each ratingDis}}
                        { y: {{this}}, label: "{{@key}}" },
                    {{/each}}
                    ]
                }]
            });
            chart.render();


            //bar chart for levels
            var chart = new CanvasJS.Chart("chartContainer2", {
                animationEnabled: true,
                theme: "light2", // "light1", "light2", "dark1", "dark2"
                title: {
                text: "Levels of {{handle}}"
                },
                axisX: {
                    interval:1,
                    labelAutoFit: false
                },
                data: [{
                    type: "column",
                    dataPoints: [
                    {{#each levelDis}}
                        { y: {{this}}, label: "{{@key}}" },
                    {{/each}}
                    ]
                }]
            });
            chart.render();

            // Pie chart for Verdicts
            var chart = new CanvasJS.Chart("chartContainer3", {
                animationEnabled: true,
                title: {
                    text: "Verdicts of {{handle}}"
                },
                legend: {
                    cursor: "pointer",
                    itemclick: explodePie
                },
                data: [{
                    type: "pie",
                    showInLegend: true,
                    toolTipContent: "{name}: <strong>{y}</strong>",
                    dataPoints: [
                        {{#each verdicts}}
                        { y: {{this}}, name: "{{@key}}"},
                        {{/each}}
                    ]
                }]
            });
            chart.render();
        }

        function explodePie(e) {
                if (typeof (e.dataSeries.dataPoints[e.dataPointIndex].exploded) === "undefined" || !e.dataSeries.dataPoints[e.dataPointIndex].exploded) {
                    e.dataSeries.dataPoints[e.dataPointIndex].exploded = true;
                } else {
                    e.dataSeries.dataPoints[e.dataPointIndex].exploded = false;
                }
                e.chart.render();
            }
    </script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/analytics.css">
    <link rel="stylesheet" href="/css/style.css">

</head>
<body>
    {{>header}}
    <div class="container-xxl mt-4">
        <div class="form_container">
        <form class="row justify-content-center" method="POST">
               <div class="col-6 handle">
 <input name="handle" class="form-control" placeholder="Codeforces Handle" required value={{#if isDefined}}{{handle}}{{/if}}>
               
               </div>
               <div class="col-2">
<input type="submit" class="btn btn-outline-primary" value="Submit">
               </div>
                
            </form>
        </div>
    
    
    {{#if isDefined}}
    <div class="container">
        <div class="row justify-content-between mt-3">
            <div class="col-2 dp">
                    <img class="img-thumbnail profile" src={{profile.avatar}}>
                
                
                <div class="rank mt-2 m-1 btn btn-warning">
                    {{profile.rank}}
                </div>
            </div>
            
            
                
               
                    <div class="col-5">
                        
                <table class="table table-info table-striped rounded table-hover">
                    <tbody> 
                        <tr>
                            {{!-- <td scope="row"></td> --}}
                            <td>Current Rating</td>
                            <td class="text-right">{{profile.rating}}</td>
                        </tr>
                        <tr>
                            {{!-- <td scope="row"></td> --}}
                            <td>Maximum Rating</td>
                            <td class="text-right">{{profile.maxRating}}</td>
                        </tr>
                         <tr>
                            {{!-- <td scope="row"></td> --}}
                            <td>Contests</td>
                            <td class="text-right">{{profile.contests}}</td>
                        </tr>
                        <tr>
                            {{!-- <td scope="row"></td> --}}
                            <td>Tried</td>
                            <td class="text-right">{{profile.tried}}</td>
                        </tr>
                        <tr>
                            <td>
                                Solved
                            </td>
                            <td class="text-right">
                                {{profile.solved}}
                            </td>
                        </tr>
                    </tbody>
                </table>
                    </div>
                    <div class="col-5">
                        <table class="table table-primary table-striped rounded table-hover">
                    <tbody class="rounded"> 
                        <tr class="rounded">
                            {{!-- <td scope="row"></td> --}}
                            <td>Solved with Single Submission</td>
                            <td class="text-right">{{profile.oneShot}}</td>
                        </tr>
                        <tr>
                            {{!-- <td scope="row"></td> --}}
                            <td>Maximum Rank</td>
                            <td class="text-right">{{profile.maxRank}}</td>
                        </tr>
                         <tr>
                            {{!-- <td scope="row"></td> --}}
                            <td>Minimum Rank</td>
                            <td class="text-right">{{profile.minRank}}</td>
                        </tr>
                        <tr>
                            {{!-- <td scope="row"></td> --}}
                            <td>Maximum Up</td>
                            <td class="text-right">{{profile.maxUp}}</td>
                        </tr>
                        <tr>
                            <td>
                                Maximum Down
                            </td>
                            <td class="text-right">
                                {{profile.maxDown}}
                            </td>
                        </tr>
                    </tbody>
                </table>
                        
                  
                    </div>
                
               
                

                
        </div>
        <div class="row justify-content-evenly">
             <div class="col-6 mt-3 shadow p-3 m-3 bg-body rounded">
                <div id="chartContainer" style="height: 370px; width: 100%; margin: 0 auto;"></div>
            </div>
            <div class="col-6 shadow p-3 m-3 bg-body rounded">
                <div id="chartContainer3" style="height: 370px; width: 100%; margin: 0 auto;"></div>
            </div>
            <div class="col-12 shadow p-3 m-4 bg-body rounded">
                <div id="chartContainer1" style="height: 370px; width: 100%;margin: 0 auto;"></div>
    
            </div>
            <div class="col-12 shadow p-3 m-4 bg-body rounded">
                <div id="chartContainer2" class="mt-4" style="height: 370px; width: 100%;margin: 0 auto;"></div>
            </div>
           
        </div>
    
     
    
    </div>
    {{/if}}
    </div>
</body>
</html>